'use strict';
const _0x516bbe = _0x2f8a;
(function (_0x2e23b7, _0x54cc12) {
    const _0xaab07b = _0x2f8a, _0x48b907 = _0x2e23b7();
    while (!![]) {
        try {
            const _0x579532 = -parseInt(_0xaab07b(0x185)) / (0xbb1 + -0x4b * -0x52 + -0x23b6) * (-parseInt(_0xaab07b(0x148)) / (0x47 * 0x17 + 0x8ba * -0x4 + 0x5b5 * 0x5)) + -parseInt(_0xaab07b(0x16a)) / (0x2e4 * -0x6 + -0x1 * 0xc35 + -0xec8 * -0x2) * (parseInt(_0xaab07b(0x127)) / (-0x2 * 0x8d7 + 0xcc1 * 0x3 + -0x1491)) + -parseInt(_0xaab07b(0x18d)) / (0x8fb + 0x5 * -0x6de + -0x10 * -0x196) + parseInt(_0xaab07b(0x1c3)) / (-0x1644 + -0xe8a + 0x2 * 0x126a) + -parseInt(_0xaab07b(0x12b)) / (-0xfd0 + -0xab * -0x9 + -0x9d4 * -0x1) + parseInt(_0xaab07b(0x119)) / (-0x74 * -0x7 + 0x1c3 * 0x9 + -0x655 * 0x3) + parseInt(_0xaab07b(0x191)) / (-0x1cb4 + 0x1 * 0x22ae + -0x5f1);
            if (_0x579532 === _0x54cc12)
                break;
            else
                _0x48b907['push'](_0x48b907['shift']());
        } catch (_0x2ef26b) {
            _0x48b907['push'](_0x48b907['shift']());
        }
    }
}(_0x22ca, 0x2c332 + -0x2703f + 0x55bdc));
var __awaiter = this && this[_0x516bbe(0x12a)] || function (_0x453115, _0x210779, _0xa82ccd, _0x2c67fb) {
        const _0x2c6397 = _0x516bbe, _0x4bb8d8 = {
                'XRkDL': function (_0x203b71, _0x1c6b08) {
                    return _0x203b71(_0x1c6b08);
                },
                'sZnYN': function (_0x447cdd, _0x324acb) {
                    return _0x447cdd instanceof _0x324acb;
                },
                'fpiGN': _0x2c6397(0x13f),
                'vodAG': function (_0x4eeb64, _0x5e23d5) {
                    return _0x4eeb64(_0x5e23d5);
                },
                'KitSG': function (_0x93a611, _0x28a7a9) {
                    return _0x93a611(_0x28a7a9);
                },
                'NWGqY': function (_0x4551f9, _0x4b58e2) {
                    return _0x4551f9(_0x4b58e2);
                }
            };
        function _0x2a9cf3(_0x146a3d) {
            const _0x3724c2 = _0x2c6397;
            return _0x4bb8d8[_0x3724c2(0x199)](_0x146a3d, _0xa82ccd) ? _0x146a3d : new _0xa82ccd(function (_0x18950b) {
                const _0x24e20d = _0x3724c2;
                _0x4bb8d8[_0x24e20d(0x14e)](_0x18950b, _0x146a3d);
            });
        }
        return new (_0xa82ccd || (_0xa82ccd = Promise))(function (_0x233e33, _0x4b55ba) {
            const _0x2d84b7 = _0x2c6397, _0xd8f8cb = {
                    'qdgeX': function (_0x5174f0, _0x14875e) {
                        const _0x4a759e = _0x2f8a;
                        return _0x4bb8d8[_0x4a759e(0x14e)](_0x5174f0, _0x14875e);
                    }
                };
            function _0x23679b(_0x483420) {
                const _0x53c463 = _0x2f8a;
                try {
                    _0xd8f8cb[_0x53c463(0x11b)](_0x431bc9, _0x2c67fb[_0x53c463(0x11d)](_0x483420));
                } catch (_0x34224f) {
                    _0xd8f8cb[_0x53c463(0x11b)](_0x4b55ba, _0x34224f);
                }
            }
            function _0x45ddfc(_0x46de63) {
                const _0x221a22 = _0x2f8a;
                try {
                    _0x4bb8d8[_0x221a22(0x14e)](_0x431bc9, _0x2c67fb[_0x4bb8d8[_0x221a22(0x1cb)]](_0x46de63));
                } catch (_0x1739d3) {
                    _0x4bb8d8[_0x221a22(0x10f)](_0x4b55ba, _0x1739d3);
                }
            }
            function _0x431bc9(_0x29f3a2) {
                const _0x1e01d3 = _0x2f8a;
                _0x29f3a2[_0x1e01d3(0x155)] ? _0x4bb8d8[_0x1e01d3(0x1a9)](_0x233e33, _0x29f3a2[_0x1e01d3(0x1c2)]) : _0x4bb8d8[_0x1e01d3(0x130)](_0x2a9cf3, _0x29f3a2[_0x1e01d3(0x1c2)])[_0x1e01d3(0x169)](_0x23679b, _0x45ddfc);
            }
            _0x4bb8d8[_0x2d84b7(0x14e)](_0x431bc9, (_0x2c67fb = _0x2c67fb[_0x2d84b7(0x14a)](_0x453115, _0x210779 || []))[_0x2d84b7(0x11d)]());
        });
    }, __importDefault = this && this[_0x516bbe(0x12e) + _0x516bbe(0x1a1)] || function (_0x4cf9b1) {
        const _0x276a2a = _0x516bbe;
        return _0x4cf9b1 && _0x4cf9b1[_0x276a2a(0x186)] ? _0x4cf9b1 : { 'default': _0x4cf9b1 };
    };
function _0x2f8a(_0x390e81, _0x301c30) {
    const _0x4b7c5e = _0x22ca();
    return _0x2f8a = function (_0x2624eb, _0x58dced) {
        _0x2624eb = _0x2624eb - (-0x26c + -0x2222 + 0x259b);
        let _0x5e4bcc = _0x4b7c5e[_0x2624eb];
        return _0x5e4bcc;
    }, _0x2f8a(_0x390e81, _0x301c30);
}
function _0x22ca() {
    const _0x2b0342 = [
        'xDDXG',
        'body',
        'vYnaa',
        '30164Ofhaoo',
        'GNgQq',
        'apply',
        'fMQED',
        '../../help',
        'email',
        'XRkDL',
        'goUyP',
        'indexOf',
        'Services/U',
        'user',
        'ERR_CREATI',
        '../../mode',
        'done',
        'YGfkZ',
        'epsChatFlo',
        'ticket:upd',
        'cNteB',
        './VerifySt',
        'number',
        'chatFlowId',
        'model',
        '../Contact',
        'TmYoe',
        'lOHHG',
        'firstCall',
        'contactId',
        's/pupa',
        'payload',
        'erty',
        'tenantId',
        'DelayField',
        'czCRZ',
        'then',
        '28317akdFJs',
        'answered',
        'kanban',
        'EZdcB',
        'pending',
        'lastMessag',
        'TagField',
        'EDdoO',
        'vices/help',
        'contact',
        'OGjrH',
        'chat',
        'ervices/Sh',
        'YzrZi',
        '_SYSTEM',
        'zsqyv',
        '../../util',
        'sAAXL',
        'getTime',
        'typebotSta',
        'dYsQH',
        'quotedMsg',
        'JXTpm',
        'XITje',
        'default',
        'get',
        'EmzJJ',
        '26CDjjKn',
        '__esModule',
        'assign',
        'where',
        'GBHKk',
        'mNJcT',
        'time',
        'include',
        '1740695sVwxkB',
        'quHvZ',
        'HuzJm',
        'typebotRes',
        '2506833hUScwS',
        'ers/Handle',
        'typebotNam',
        'chatFlow',
        'fromMe',
        'substr',
        'rtlSf',
        'uSdow',
        'sZnYN',
        'ebot',
        'create',
        'feRlO',
        'protocol',
        '../TicketS',
        'pupa',
        'dCVRw',
        'fault',
        'axios',
        'OAjUa',
        'owTicketSe',
        'fShSv',
        'MessageTyp',
        'rvxUx',
        'typebotOff',
        'KitSG',
        'Iyxfd',
        'rvice',
        'FDZXD',
        'HCQjZ',
        'HDSIY',
        'WebhookFie',
        'MediaField',
        'tart',
        'gfMPX',
        'MmteA',
        'tag',
        'length',
        'pdateConta',
        'KhkJd',
        'nodeC',
        'typebotUrl',
        'qKrmd',
        'xPZDu',
        'FgrvF',
        'vfpmy',
        'yrTzi',
        'pNoxr',
        'chat:creat',
        'fnRlp',
        'value',
        '799758MouPER',
        'mNgnx',
        'rPrMQ',
        'tus',
        'NG_MESSAGE',
        'eld',
        'mediaType',
        'findByPk',
        'fpiGN',
        'TypebotFie',
        'jusHy',
        'ls/Ticket',
        'ISHjx',
        'vodAG',
        'lgImj',
        'SLsRE',
        'dirtp',
        'BuildSendM',
        'type',
        'ctTagsBotS',
        'ChatFlowFi',
        'logger',
        'ers/socket',
        '5489096hNDgpw',
        'ervice',
        'qdgeX',
        'bot',
        'next',
        'XSpQc',
        'AvDWg',
        'ticket',
        'lAQmr',
        'wTicket',
        'webhook',
        'ltZYm',
        'ice',
        'AwjIt',
        '172nkLpEj',
        'mediaUrl',
        'ate',
        '__awaiter',
        '2545564vatlTG',
        'data',
        'ls/Message',
        '__importDe',
        's/logger',
        'NWGqY',
        'essageServ',
        'SxQbn',
        'split',
        '../WbotSer',
        'lrefl',
        'string',
        'defineProp',
        'error',
        'name',
        'WsFep',
        'wQdPG',
        'Emit',
        'message',
        'thhvY',
        'throw',
        'toString',
        'update',
        'jRVTI',
        'fSQVv',
        'stepChatFl'
    ];
    _0x22ca = function () {
        return _0x2b0342;
    };
    return _0x22ca();
}
const _0x3fbe2e = {};
_0x3fbe2e[_0x516bbe(0x1c2)] = !![], Object[_0x516bbe(0x137) + _0x516bbe(0x165)](exports, _0x516bbe(0x186), _0x3fbe2e);
const pupa_1 = require(_0x516bbe(0x17a) + _0x516bbe(0x163)), logger_1 = require(_0x516bbe(0x17a) + _0x516bbe(0x12f)), Ticket_1 = __importDefault(require(_0x516bbe(0x154) + _0x516bbe(0x10d))), Message_1 = __importDefault(require(_0x516bbe(0x154) + _0x516bbe(0x12d))), socketEmit_1 = __importDefault(require(_0x516bbe(0x14c) + _0x516bbe(0x118) + _0x516bbe(0x13c))), UpdateContactTagsBotService_1 = __importDefault(require(_0x516bbe(0x15e) + _0x516bbe(0x151) + _0x516bbe(0x1b6) + _0x516bbe(0x115) + _0x516bbe(0x11a))), axios_1 = __importDefault(require(_0x516bbe(0x1a2))), ShowTicketService_1 = __importDefault(require(_0x516bbe(0x19e) + _0x516bbe(0x176) + _0x516bbe(0x1a4) + _0x516bbe(0x1ab))), VerifyStepsChatFlowTicket_1 = __importDefault(require(_0x516bbe(0x15a) + _0x516bbe(0x157) + _0x516bbe(0x122))), HandleMessageTypebot_1 = __importDefault(require(_0x516bbe(0x134) + _0x516bbe(0x172) + _0x516bbe(0x192) + _0x516bbe(0x1a6) + _0x516bbe(0x19a))), BuildSendMessageService = ({
        wbot: _0x1b0c1e,
        wbotMessage: _0x346460,
        msg: _0x50489e,
        tenantId: _0x229520,
        ticket: _0x14a042,
        userId: _0x1ecfbc
    }) => __awaiter(void (0x2162 + 0x2 * -0x1296 + 0x3ca), void (-0x2485 + -0x1aec + 0x95 * 0x6d), void (0xb8c + -0x11 * -0x67 + 0x1263 * -0x1), function* () {
        const _0x4a526f = _0x516bbe, _0x31aade = {
                'feRlO': function (_0x595e75, _0x5c6d11) {
                    return _0x595e75(_0x5c6d11);
                },
                'gfMPX': function (_0x19c376, _0x4cccc9, _0x208a61, _0x2e4d90, _0x435da8) {
                    return _0x19c376(_0x4cccc9, _0x208a61, _0x2e4d90, _0x435da8);
                },
                'jusHy': _0x4a526f(0x175),
                'EDdoO': _0x4a526f(0x11c),
                'jRVTI': _0x4a526f(0x16e),
                'GBHKk': function (_0x3e1e06, _0x57301b) {
                    return _0x3e1e06 === _0x57301b;
                },
                'zsqyv': _0x4a526f(0x1cc) + 'ld',
                'yrTzi': _0x4a526f(0x158) + _0x4a526f(0x129),
                'dirtp': _0x4a526f(0x113) + _0x4a526f(0x131) + _0x4a526f(0x125),
                'Iyxfd': _0x4a526f(0x116) + _0x4a526f(0x1c8),
                'WsFep': _0x4a526f(0x1b8),
                'qKrmd': _0x4a526f(0x1af) + 'ld',
                'MmteA': function (_0x4297ba, _0x300a47) {
                    return _0x4297ba === _0x300a47;
                },
                'vfpmy': function (_0x5b725c, _0x4e3279) {
                    return _0x5b725c === _0x4e3279;
                },
                'rtlSf': function (_0x45eb7a, _0x579b4f) {
                    return _0x45eb7a === _0x579b4f;
                },
                'ltZYm': function (_0x5b059d, _0x71f291) {
                    return _0x5b059d === _0x71f291;
                },
                'goUyP': function (_0x19d858, _0x507c23) {
                    return _0x19d858 === _0x507c23;
                },
                'fMQED': function (_0x2551b2, _0x4067b9) {
                    return _0x2551b2 === _0x4067b9;
                },
                'GNgQq': function (_0x3dbe74, _0xc03acf) {
                    return _0x3dbe74 === _0xc03acf;
                },
                'vYnaa': function (_0x230978, _0x228c10) {
                    return _0x230978 === _0x228c10;
                },
                'XITje': function (_0x3876b3, _0x65d91d) {
                    return _0x3876b3 === _0x65d91d;
                },
                'lAQmr': function (_0x1c4bdd, _0x31556c) {
                    return _0x1c4bdd === _0x31556c;
                },
                'XSpQc': function (_0x28f7e6, _0x4adc27) {
                    return _0x28f7e6 === _0x4adc27;
                },
                'AwjIt': function (_0x52e9c8, _0x212427) {
                    return _0x52e9c8 === _0x212427;
                },
                'FgrvF': function (_0x620dac, _0x54e5fe) {
                    return _0x620dac === _0x54e5fe;
                },
                'KhkJd': function (_0x243550, _0x5cdce4) {
                    return _0x243550 === _0x5cdce4;
                },
                'pNoxr': function (_0x5b58f8, _0x19100e) {
                    return _0x5b58f8 === _0x19100e;
                },
                'TmYoe': function (_0x5e2679, _0x3815b7) {
                    return _0x5e2679 === _0x3815b7;
                },
                'mNJcT': function (_0x5e5bfc, _0x36c045) {
                    return _0x5e5bfc === _0x36c045;
                },
                'quHvZ': function (_0x28f16b, _0x335109) {
                    return _0x28f16b === _0x335109;
                },
                'fnRlp': _0x4a526f(0x136),
                'SLsRE': _0x4a526f(0x170),
                'lrefl': function (_0x3ddbe4, _0x25c751) {
                    return _0x3ddbe4 === _0x25c751;
                },
                'SxQbn': _0x4a526f(0x167),
                'EZdcB': function (_0x3beef1, _0x173b8c) {
                    return _0x3beef1 * _0x173b8c;
                },
                'thhvY': function (_0x482d3e) {
                    return _0x482d3e();
                },
                'HuzJm': function (_0x2cbb46, _0x65a739) {
                    return _0x2cbb46 === _0x65a739;
                },
                'FDZXD': _0x4a526f(0x1b0),
                'xDDXG': function (_0x2ec1aa, _0x42cdcf) {
                    return _0x2ec1aa - _0x42cdcf;
                },
                'uSdow': function (_0x590ff8, _0x47d218) {
                    return _0x590ff8 === _0x47d218;
                },
                'dYsQH': _0x4a526f(0x120),
                'rvxUx': _0x4a526f(0x173),
                'YzrZi': _0x4a526f(0x17f),
                'HDSIY': _0x4a526f(0x153) + _0x4a526f(0x1c7) + _0x4a526f(0x178),
                'cNteB': _0x4a526f(0x1c0) + 'e',
                'YGfkZ': function (_0x3f4439, _0x58ef42) {
                    return _0x3f4439 !== _0x58ef42;
                },
                'EmzJJ': function (_0x84ae35, _0x21792d) {
                    return _0x84ae35 !== _0x21792d;
                },
                'HCQjZ': function (_0x4589b3, _0x329b24) {
                    return _0x4589b3 !== _0x329b24;
                },
                'fSQVv': function (_0x169bac, _0x2c1977) {
                    return _0x169bac !== _0x2c1977;
                },
                'mNgnx': function (_0x5cef12, _0x2d3f2a) {
                    return _0x5cef12 === _0x2d3f2a;
                },
                'sAAXL': function (_0x5386ab, _0x53462f) {
                    return _0x5386ab === _0x53462f;
                },
                'rPrMQ': function (_0x18d244, _0x1d6aa0) {
                    return _0x18d244 === _0x1d6aa0;
                },
                'lOHHG': function (_0x23f155, _0x5b4869) {
                    return _0x23f155 === _0x5b4869;
                },
                'OAjUa': function (_0xfda1c1, _0x4427b0) {
                    return _0xfda1c1 === _0x4427b0;
                },
                'ISHjx': function (_0x54134d, _0x560c50) {
                    return _0x54134d === _0x560c50;
                },
                'xPZDu': function (_0x498ed8, _0x85e03e) {
                    return _0x498ed8 === _0x85e03e;
                },
                'fShSv': function (_0x3b29ef, _0x351225) {
                    return _0x3b29ef === _0x351225;
                },
                'lgImj': function (_0x2a2358, _0x383dd8) {
                    return _0x2a2358 === _0x383dd8;
                },
                'JXTpm': function (_0x4b85a1, _0x45121f) {
                    return _0x4b85a1 === _0x45121f;
                },
                'wQdPG': function (_0x526328, _0x5df4dd) {
                    return _0x526328 === _0x5df4dd;
                },
                'OGjrH': function (_0x415e3f, _0x493ae9) {
                    return _0x415e3f === _0x493ae9;
                },
                'dCVRw': function (_0x41d2ff, _0x108cd4) {
                    return _0x41d2ff === _0x108cd4;
                },
                'czCRZ': function (_0xb5d9ee, _0x3893f2) {
                    return _0xb5d9ee === _0x3893f2;
                },
                'AvDWg': function (_0x10f178, _0x5ef627) {
                    return _0x10f178 === _0x5ef627;
                }
            };
        var _0x324a38, _0x45c74f, _0x4db749, _0x55312f, _0x22f832, _0x4337cf, _0x5995e1, _0x5ee503, _0x1ee15b, _0x58e77d, _0x843888, _0x578cdb, _0x341fde;
        const _0x265c4b = {
            'ticketId': _0x14a042['id'],
            'body': '',
            'contactId': _0x14a042[_0x4a526f(0x162)],
            'fromMe': !![],
            'read': !![],
            'mediaType': _0x31aade[_0x4a526f(0x1cd)],
            'mediaUrl': undefined,
            'timestamp': new Date()[_0x4a526f(0x17c)](),
            'quotedMsgId': undefined,
            'userId': _0x1ecfbc,
            'scheduleDate': undefined,
            'sendType': _0x31aade[_0x4a526f(0x171)],
            'status': _0x31aade[_0x4a526f(0x142)],
            'tenantId': _0x229520
        };
        try {
            if (_0x31aade[_0x4a526f(0x189)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x179)]) && _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x1b9)])
                try {
                    const _0xb3e44c = {};
                    _0xb3e44c[_0x4a526f(0x1b9)] = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x1b9)], _0xb3e44c[_0x4a526f(0x193) + 'e'] = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x193) + 'e'], _0xb3e44c[_0x4a526f(0x1a8)] = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x1a8)], _0xb3e44c[_0x4a526f(0x190) + _0x4a526f(0x1b1)] = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x190) + _0x4a526f(0x1b1)], _0xb3e44c[_0x4a526f(0x17d) + _0x4a526f(0x1c6)] = !![], _0xb3e44c[_0x4a526f(0x15c)] = null, _0xb3e44c[_0x4a526f(0x144) + 'ow'] = null, yield _0x14a042[_0x4a526f(0x141)](_0xb3e44c);
                    const _0x113e96 = {};
                    _0x113e96['id'] = _0x14a042['id'], _0x113e96[_0x4a526f(0x166)] = _0x14a042[_0x4a526f(0x166)];
                    const _0x37dc9e = yield (-0x1 * -0x22e1 + 0x135 * 0x19 + 0x2f5 * -0x16, ShowTicketService_1[_0x4a526f(0x182)])(_0x113e96), _0x310d9d = {};
                    _0x310d9d[_0x4a526f(0x166)] = _0x14a042[_0x4a526f(0x166)], _0x310d9d[_0x4a526f(0x114)] = _0x31aade[_0x4a526f(0x1be)], _0x310d9d[_0x4a526f(0x164)] = _0x37dc9e, (-0x25a3 + -0x75a + 0x2cfd, socketEmit_1[_0x4a526f(0x182)])(_0x310d9d);
                    if (!_0x1b0c1e)
                        return;
                    yield (-0x92 + 0xde5 + -0xd53, HandleMessageTypebot_1[_0x4a526f(0x182)])(_0x1b0c1e, _0x346460, _0x37dc9e);
                } catch (_0x42468e) {
                    logger_1[_0x4a526f(0x117)][_0x4a526f(0x138)](_0x31aade[_0x4a526f(0x112)], _0x42468e);
                }
            if (_0x31aade[_0x4a526f(0x189)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x1aa)]) && _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x194)])
                try {
                    const _0x19b35a = {};
                    _0x19b35a[_0x4a526f(0x15c)] = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x194)], _0x19b35a[_0x4a526f(0x144) + 'ow'] = _0x31aade[_0x4a526f(0x13a)], _0x19b35a[_0x4a526f(0x16b)] = ![], _0x19b35a[_0x4a526f(0x161)] = !![], yield _0x14a042[_0x4a526f(0x141)](_0x19b35a);
                    const _0x4bd502 = {};
                    _0x4bd502['id'] = _0x14a042['id'], _0x4bd502[_0x4a526f(0x166)] = _0x14a042[_0x4a526f(0x166)];
                    const _0x2ea0c1 = yield (0x7fb + -0x101a * 0x1 + 0x1 * 0x81f, ShowTicketService_1[_0x4a526f(0x182)])(_0x4bd502), _0x109380 = {};
                    _0x109380[_0x4a526f(0x166)] = _0x14a042[_0x4a526f(0x166)], _0x109380[_0x4a526f(0x114)] = _0x31aade[_0x4a526f(0x1be)], _0x109380[_0x4a526f(0x164)] = _0x2ea0c1, (0xd * -0xb9 + -0x26 * 0x88 + 0x1d95, socketEmit_1[_0x4a526f(0x182)])(_0x109380);
                    const _0x15f761 = {};
                    _0x15f761[_0x4a526f(0x146)] = _0x14a042[_0x4a526f(0x16f) + 'e'], _0x15f761[_0x4a526f(0x195)] = ![];
                    const _0x168ce0 = _0x15f761;
                    if (!_0x1b0c1e)
                        return;
                    yield (-0x580 + -0x6ae + 0x617 * 0x2, VerifyStepsChatFlowTicket_1[_0x4a526f(0x182)])(_0x1b0c1e, _0x168ce0, _0x14a042);
                } catch (_0x3382ea) {
                    logger_1[_0x4a526f(0x117)][_0x4a526f(0x138)](_0x31aade[_0x4a526f(0x112)], _0x3382ea);
                }
            if (_0x31aade[_0x4a526f(0x189)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x1ba)]) && _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x123)]) {
                if (_0x31aade[_0x4a526f(0x1b3)](_0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x123)], ''))
                    return;
                try {
                    _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x123)] = (0x1556 + -0x1279 + -0x2dd * 0x1, pupa_1[_0x4a526f(0x19f)])(_0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x123)] || '', {
                        'protocol': (_0x31aade[_0x4a526f(0x1b3)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1b3)](_0x14a042, void (0x10bb + -0x22a * 0x1 + 0xe91 * -0x1)) ? void (0x3 * -0x4cf + 0x1 * 0x1d5c + -0xeef) : _0x14a042[_0x4a526f(0x19d)]) || '',
                        'name': (_0x31aade[_0x4a526f(0x1b3)](_0x324a38 = _0x31aade[_0x4a526f(0x1bd)](_0x14a042, null) || _0x31aade[_0x4a526f(0x197)](_0x14a042, void (0x4d8 * -0x1 + -0x22da + -0x1 * -0x27b2)) ? void (0x1ec7 + -0x2 * 0xff5 + -0x123 * -0x1) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x124)](_0x324a38, void (-0x143 * -0xd + 0x1 * -0x20e + -0xe59)) ? void (0x116 + 0x340 * -0x6 + 0x126a) : _0x324a38[_0x4a526f(0x139)]) || '',
                        'email': (_0x31aade[_0x4a526f(0x14f)](_0x45c74f = _0x31aade[_0x4a526f(0x189)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1bd)](_0x14a042, void (-0x1eb3 + -0x2 * -0x949 + 0x26d * 0x5)) ? void (0xe * -0x51 + -0x361 * -0x3 + 0x3 * -0x1e7) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x14b)](_0x45c74f, void (-0x248 + 0x7cc * 0x1 + -0x584)) ? void (-0x1 * -0x833 + 0x99b * -0x3 + 0x149e) : _0x45c74f[_0x4a526f(0x14d)]) || '',
                        'phoneNumber': (_0x31aade[_0x4a526f(0x149)](_0x4db749 = _0x31aade[_0x4a526f(0x147)](_0x14a042, null) || _0x31aade[_0x4a526f(0x181)](_0x14a042, void (-0x117e * 0x1 + -0xd0 * -0x2b + -0x7 * 0x27e)) ? void (0xf4e + -0x9c * -0x35 + -0x2f9a) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x14b)](_0x4db749, void (0xb * -0x67 + 0x926 * -0x1 + 0xd93)) ? void (0x5 * 0x43b + -0x72a + -0xdfd) : _0x4db749[_0x4a526f(0x15b)]) || '',
                        'kanban': (_0x31aade[_0x4a526f(0x121)](_0x55312f = _0x31aade[_0x4a526f(0x11e)](_0x14a042, null) || _0x31aade[_0x4a526f(0x126)](_0x14a042, void (-0x15a4 + -0xe99 * 0x2 + 0x32d6)) ? void (0x185e + -0x1a * 0xbf + -0x4f8) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x147)](_0x55312f, void (-0x611 * 0x1 + -0xb4 + -0x1 * -0x6c5)) ? void (0x1 * -0x25a2 + 0xa21 + 0x3 * 0x92b) : _0x55312f[_0x4a526f(0x16c)]) || '',
                        'user': (_0x31aade[_0x4a526f(0x11e)](_0x22f832 = _0x31aade[_0x4a526f(0x1bc)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1b7)](_0x14a042, void (0x120b + 0x261e + 0x1 * -0x3829)) ? void (-0xc * 0x314 + -0xb * 0x119 + 0x3103 * 0x1) : _0x14a042[_0x4a526f(0x152)], null) || _0x31aade[_0x4a526f(0x121)](_0x22f832, void (0x1 * 0x1d0b + 0x1241 + -0x2f4c)) ? void (-0x12e8 + -0x5f9 + 0x18e1) : _0x22f832[_0x4a526f(0x139)]) || '',
                        'userEmail': (_0x31aade[_0x4a526f(0x1bf)](_0x4337cf = _0x31aade[_0x4a526f(0x15f)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1bc)](_0x14a042, void (0x1f4 + 0x14ad * -0x1 + 0x12b9)) ? void (-0x185 * -0x2 + -0x6b1 + 0x3a7) : _0x14a042[_0x4a526f(0x152)], null) || _0x31aade[_0x4a526f(0x18a)](_0x4337cf, void (0x57 * 0x32 + -0x2 * 0xd36 + -0x1 * -0x96e)) ? void (-0x1 * 0xdca + -0x5d9 + 0x13a3 * 0x1) : _0x4337cf[_0x4a526f(0x14d)]) || ''
                    }), _0x31aade[_0x4a526f(0x18e)](typeof _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x123)], _0x31aade[_0x4a526f(0x1c1)]) && (yield axios_1[_0x4a526f(0x182)][_0x4a526f(0x183)](_0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x123)]));
                } catch (_0x2f95e3) {
                    logger_1[_0x4a526f(0x117)][_0x4a526f(0x138)](_0x31aade[_0x4a526f(0x112)], _0x2f95e3);
                }
            }
            if (_0x31aade[_0x4a526f(0x126)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x111)]) && _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x1b4)]) {
                if (_0x31aade[_0x4a526f(0x15f)](_0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x1b4)], null))
                    return;
                yield (-0x23f8 * 0x1 + 0x1e47 + -0x1 * -0x5b1, UpdateContactTagsBotService_1[_0x4a526f(0x182)])({
                    'tagId': _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x1b4)],
                    'contactId': _0x14a042[_0x4a526f(0x162)][_0x4a526f(0x140)](),
                    'tenantId': _0x229520
                });
            }
            if (_0x31aade[_0x4a526f(0x135)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x132)]) && _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x18b)]) {
                const _0x19bd84 = _0x3403ec => new Promise(_0x502b67 => setTimeout(_0x502b67, _0x3403ec)), _0x4b0bb9 = _0x31aade[_0x4a526f(0x16d)](_0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x18b)], -0x1 * -0x1c2b + -0x2 * -0xc15 + -0x1 * 0x306d);
                function _0x102591() {
                    const _0x1e8d0e = _0x4a526f;
                    return _0x31aade[_0x1e8d0e(0x1b2)](__awaiter, this, void (0x1fc7 + -0x998 * -0x4 + -0x4627), void (-0x2 * 0x24b + -0x1b81 + 0x2017), function* () {
                        const _0x5c527 = _0x1e8d0e;
                        yield _0x31aade[_0x5c527(0x19c)](_0x19bd84, _0x4b0bb9);
                    });
                }
                yield _0x31aade[_0x4a526f(0x13e)](_0x102591);
            }
            if (_0x31aade[_0x4a526f(0x18f)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x1ac)]) && _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x128)]) {
                const _0x566096 = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x128)][_0x4a526f(0x133)]('/'), _0x521b59 = Object[_0x4a526f(0x187)](Object[_0x4a526f(0x187)]({}, _0x265c4b), {
                        'body': _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x139)],
                        'mediaUrl': _0x566096[_0x31aade[_0x4a526f(0x145)](_0x566096[_0x4a526f(0x1b5)], -0xc3d * 0x1 + -0x4b8 + 0x10f6)],
                        'mediaType': _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x114)] ? _0x31aade[_0x4a526f(0x15f)](_0x5995e1 = _0x50489e[_0x4a526f(0x12c)], null) || _0x31aade[_0x4a526f(0x198)](_0x5995e1, void (0x1a3d * 0x1 + -0x446 + -0x15f7)) ? void (-0x1af9 + 0x1d0a + -0x1 * 0x211) : _0x5995e1[_0x4a526f(0x114)][_0x4a526f(0x196)](0x12e0 + 0x3 * -0xb4d + 0xf07, _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x114)][_0x4a526f(0x150)]('/')) : _0x31aade[_0x4a526f(0x1cd)]
                    }), _0x46d2ca = yield Message_1[_0x4a526f(0x182)][_0x4a526f(0x19b)](_0x521b59), _0x485c90 = {};
                _0x485c90[_0x4a526f(0x166)] = _0x229520;
                const _0x898a2 = {};
                _0x898a2[_0x4a526f(0x15d)] = Ticket_1[_0x4a526f(0x182)], _0x898a2['as'] = _0x31aade[_0x4a526f(0x17e)], _0x898a2[_0x4a526f(0x188)] = _0x485c90, _0x898a2[_0x4a526f(0x18c)] = [_0x31aade[_0x4a526f(0x1a7)]];
                const _0x1c9fe7 = yield Message_1[_0x4a526f(0x182)][_0x4a526f(0x1ca)](_0x46d2ca['id'], {
                    'include': [
                        _0x898a2,
                        {
                            'model': Message_1[_0x4a526f(0x182)],
                            'as': _0x31aade[_0x4a526f(0x177)],
                            'include': [_0x31aade[_0x4a526f(0x1a7)]]
                        }
                    ]
                });
                if (!_0x1c9fe7)
                    throw new Error(_0x31aade[_0x4a526f(0x1ae)]);
                yield _0x14a042[_0x4a526f(0x141)]({
                    'lastMessage': _0x1c9fe7[_0x4a526f(0x146)],
                    'lastMessageAt': new Date()[_0x4a526f(0x17c)]()
                });
                const _0xc3118b = {};
                _0xc3118b[_0x4a526f(0x166)] = _0x229520, _0xc3118b[_0x4a526f(0x114)] = _0x31aade[_0x4a526f(0x159)], _0xc3118b[_0x4a526f(0x164)] = _0x1c9fe7, (-0x1353 + -0x2268 + 0x35bb, socketEmit_1[_0x4a526f(0x182)])(_0xc3118b);
            } else {
                if (_0x31aade[_0x4a526f(0x156)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x132)]) && _0x31aade[_0x4a526f(0x184)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x1ac)]) && _0x31aade[_0x4a526f(0x156)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x111)]) && _0x31aade[_0x4a526f(0x1ad)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x1ba)]) && _0x31aade[_0x4a526f(0x143)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x1aa)]) && _0x31aade[_0x4a526f(0x143)](_0x50489e[_0x4a526f(0x114)], _0x31aade[_0x4a526f(0x179)])) {
                    _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x13d)] = (-0x5 * -0x2f9 + -0xacd + -0x68 * 0xa, pupa_1[_0x4a526f(0x19f)])(_0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x13d)] || '', {
                        'protocol': (_0x31aade[_0x4a526f(0x18a)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1c4)](_0x14a042, void (-0x14d1 + 0xbff + 0x469 * 0x2)) ? void (0x1 * -0x57e + 0x1d72 + -0x17f4) : _0x14a042[_0x4a526f(0x19d)]) || '',
                        'name': (_0x31aade[_0x4a526f(0x17b)](_0x5ee503 = _0x31aade[_0x4a526f(0x1c5)](_0x14a042, null) || _0x31aade[_0x4a526f(0x121)](_0x14a042, void (-0xe7e + -0x3da + 0x24b * 0x8)) ? void (-0x1 * 0x1948 + 0x10c * 0x25 + -0xd74) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x126)](_0x5ee503, void (0x260c + -0x1ec5 * 0x1 + -0x747)) ? void (-0x195 * 0xb + -0x1 * -0x1f7b + 0x6a * -0x22) : _0x5ee503[_0x4a526f(0x139)]) || '',
                        'email': (_0x31aade[_0x4a526f(0x147)](_0x1ee15b = _0x31aade[_0x4a526f(0x160)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1a3)](_0x14a042, void (-0x981 * -0x1 + -0x13ff + 0xa7e)) ? void (-0x14ce + -0x8f3 * -0x2 + 0x2e8) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x10e)](_0x1ee15b, void (0x2a2 + 0x7 * -0x1d0 + 0xa0e)) ? void (0x30b + 0x1 * 0xdea + -0x3 * 0x5a7) : _0x1ee15b[_0x4a526f(0x14d)]) || '',
                        'phoneNumber': (_0x31aade[_0x4a526f(0x1b7)](_0x58e77d = _0x31aade[_0x4a526f(0x1bb)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1a5)](_0x14a042, void (-0x1742 + 0x2316 + 0x2f5 * -0x4)) ? void (-0x1ce2 + -0x1 * -0x710 + 0x15 * 0x10a) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x121)](_0x58e77d, void (-0x26ca + -0xe67 + -0x33 * -0x10b)) ? void (-0x24a1 + 0x134a + -0x1157 * -0x1) : _0x58e77d[_0x4a526f(0x15b)]) || '',
                        'kanban': (_0x31aade[_0x4a526f(0x110)](_0x843888 = _0x31aade[_0x4a526f(0x180)](_0x14a042, null) || _0x31aade[_0x4a526f(0x13b)](_0x14a042, void (-0x11 * 0x20 + 0x1 * 0x1766 + 0xe * -0x185)) ? void (0xc0a + 0x1 * -0x10a7 + 0x49d) : _0x14a042[_0x4a526f(0x173)], null) || _0x31aade[_0x4a526f(0x15f)](_0x843888, void (-0x8e5 + -0x160 + 0xa45)) ? void (-0xb16 + -0x124e + -0x273 * -0xc) : _0x843888[_0x4a526f(0x16c)]) || '',
                        'user': (_0x31aade[_0x4a526f(0x174)](_0x578cdb = _0x31aade[_0x4a526f(0x198)](_0x14a042, null) || _0x31aade[_0x4a526f(0x1a0)](_0x14a042, void (0x134 * -0x6 + -0xbf3 * 0x1 + 0x132b)) ? void (0x1 * 0x265f + 0x10 + -0x266f) : _0x14a042[_0x4a526f(0x152)], null) || _0x31aade[_0x4a526f(0x168)](_0x578cdb, void (0x24f2 + 0xe92 + -0x3384)) ? void (-0xab8 + 0x244 + 0x4 * 0x21d) : _0x578cdb[_0x4a526f(0x139)]) || '',
                        'userEmail': (_0x31aade[_0x4a526f(0x1a5)](_0x341fde = _0x31aade[_0x4a526f(0x1bc)](_0x14a042, null) || _0x31aade[_0x4a526f(0x11f)](_0x14a042, void (-0x1 * -0xa77 + 0xfb1 * -0x2 + 0x99 * 0x23)) ? void (0x173 + 0x248a + -0x25fd) : _0x14a042[_0x4a526f(0x152)], null) || _0x31aade[_0x4a526f(0x180)](_0x341fde, void (0x288 + -0x5 * -0x452 + -0x1822)) ? void (-0x509 + -0x652 + 0x143 * 0x9) : _0x341fde[_0x4a526f(0x14d)]) || ''
                    });
                    const _0x4f42c9 = {};
                    _0x4f42c9[_0x4a526f(0x146)] = _0x50489e[_0x4a526f(0x12c)][_0x4a526f(0x13d)], _0x4f42c9[_0x4a526f(0x1c9)] = _0x31aade[_0x4a526f(0x1cd)];
                    const _0x153f85 = yield Message_1[_0x4a526f(0x182)][_0x4a526f(0x19b)](Object[_0x4a526f(0x187)](Object[_0x4a526f(0x187)]({}, _0x265c4b), _0x4f42c9)), _0x55a7e8 = {};
                    _0x55a7e8[_0x4a526f(0x166)] = _0x229520;
                    const _0x581cb0 = {};
                    _0x581cb0[_0x4a526f(0x15d)] = Ticket_1[_0x4a526f(0x182)], _0x581cb0['as'] = _0x31aade[_0x4a526f(0x17e)], _0x581cb0[_0x4a526f(0x188)] = _0x55a7e8, _0x581cb0[_0x4a526f(0x18c)] = [_0x31aade[_0x4a526f(0x1a7)]];
                    const _0x45975d = yield Message_1[_0x4a526f(0x182)][_0x4a526f(0x1ca)](_0x153f85['id'], {
                        'include': [
                            _0x581cb0,
                            {
                                'model': Message_1[_0x4a526f(0x182)],
                                'as': _0x31aade[_0x4a526f(0x177)],
                                'include': [_0x31aade[_0x4a526f(0x1a7)]]
                            }
                        ]
                    });
                    if (!_0x45975d)
                        throw new Error(_0x31aade[_0x4a526f(0x1ae)]);
                    yield _0x14a042[_0x4a526f(0x141)]({
                        'lastMessage': _0x45975d[_0x4a526f(0x146)],
                        'lastMessageAt': new Date()[_0x4a526f(0x17c)](),
                        'answered': !![]
                    });
                    const _0x3daedf = {};
                    _0x3daedf[_0x4a526f(0x166)] = _0x229520, _0x3daedf[_0x4a526f(0x114)] = _0x31aade[_0x4a526f(0x159)], _0x3daedf[_0x4a526f(0x164)] = _0x45975d, (0x1d61 * 0x1 + 0x1395 + -0x30f6, socketEmit_1[_0x4a526f(0x182)])(_0x3daedf);
                }
            }
        } catch (_0x3561bd) {
            logger_1[_0x4a526f(0x117)][_0x4a526f(0x138)](_0x31aade[_0x4a526f(0x112)], _0x3561bd);
        }
    });
exports[_0x516bbe(0x182)] = BuildSendMessageService;