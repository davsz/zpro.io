'use strict';
const _0x20653d = _0x378a;
(function (_0x4c4319, _0x21a172) {
    const _0x2a8ade = _0x378a, _0x37b656 = _0x4c4319();
    while (!![]) {
        try {
            const _0x5182c4 = -parseInt(_0x2a8ade(0x190)) / (-0x26fa * 0x1 + -0x101 * 0x17 + -0x635 * -0xa) + parseInt(_0x2a8ade(0x163)) / (0x1d58 + 0x6cd * 0x5 + -0x3f57) * (-parseInt(_0x2a8ade(0x15d)) / (-0x155 * 0x12 + 0xb8f + -0x637 * -0x2)) + -parseInt(_0x2a8ade(0x146)) / (-0x21cb * -0x1 + -0xecf + -0x97c * 0x2) + parseInt(_0x2a8ade(0x183)) / (-0x5d * -0x2f + -0x163c + -0x2 * -0x297) + -parseInt(_0x2a8ade(0x178)) / (0xef + 0x212d + -0x110b * 0x2) + -parseInt(_0x2a8ade(0x17c)) / (0x4a * -0x1d + 0x23ac * 0x1 + -0x3e5 * 0x7) * (parseInt(_0x2a8ade(0x147)) / (0x18ff + -0x1b * 0x8d + -0xa18)) + parseInt(_0x2a8ade(0x148)) / (0x1 * 0x22a3 + -0x61d + -0x1c7d);
            if (_0x5182c4 === _0x21a172)
                break;
            else
                _0x37b656['push'](_0x37b656['shift']());
        } catch (_0x2f395e) {
            _0x37b656['push'](_0x37b656['shift']());
        }
    }
}(_0x3e0a, -0x3197f + 0x5e4e9 + 0x5b074));
function _0x3e0a() {
    const _0x5e8800 = [
        'findOne',
        '../TicketS',
        'ervices/Sh',
        'findByPk',
        'body',
        'whatsappId',
        'rYxHr',
        'then',
        'sequelize',
        'mediaType',
        'type',
        '5089194XbeLOX',
        'update',
        '_SYSTEM',
        'dmdcK',
        '30471zQjgGk',
        'include',
        'value',
        'pending',
        'default',
        'defineProp',
        'throw',
        '5229440oeJDIw',
        'apply',
        'kSyXq',
        'ejPIB',
        'ERR_CREATI',
        'Emit',
        'ls/Ticket',
        'payload',
        'KdHeM',
        'dZrCb',
        'snmBO',
        'cYghD',
        'Ykpaz',
        '672465gSiMZT',
        'wnZaw',
        'open',
        'chat',
        'chat:creat',
        'DAJvU',
        'mediaName',
        'contactId',
        '1162336GDnoGk',
        '1792AiMwBz',
        '25081803TWndGO',
        'model',
        'where',
        'getTime',
        'hEMvK',
        'ticket',
        'jCooM',
        'boVMT',
        'contact',
        'erty',
        '../../help',
        'tenantId',
        '../../mode',
        '__importDe',
        'PdZWD',
        'rvice',
        'ls/Message',
        'zshor',
        'jeGux',
        '__awaiter',
        'ers/socket',
        '9SLWeTp',
        'create',
        'status',
        'quotedMsg',
        'NG_MESSAGE',
        'next',
        '326958KKvjJQ',
        'done',
        'ROhDs',
        'ZhsNp',
        '__esModule',
        'fault',
        'owTicketSe',
        'isGroup',
        'dYacY',
        'emjnf'
    ];
    _0x3e0a = function () {
        return _0x5e8800;
    };
    return _0x3e0a();
}
var __awaiter = this && this[_0x20653d(0x15b)] || function (_0x60c9c1, _0x51d918, _0x33d613, _0x5af552) {
        const _0x315cc9 = _0x20653d, _0x3b8a7b = {
                'jeGux': function (_0x4d9bab, _0x1b802c) {
                    return _0x4d9bab(_0x1b802c);
                },
                'ejPIB': function (_0x2ae495, _0x11d4ee) {
                    return _0x2ae495 instanceof _0x11d4ee;
                },
                'KdHeM': function (_0x2ba757, _0xbef152) {
                    return _0x2ba757(_0xbef152);
                },
                'snmBO': function (_0x527ad1, _0xeb053b) {
                    return _0x527ad1(_0xeb053b);
                },
                'cYghD': _0x315cc9(0x182),
                'boVMT': function (_0x2b9111, _0x6b1de3) {
                    return _0x2b9111(_0x6b1de3);
                }
            };
        function _0x3ec674(_0x2bc24f) {
            const _0x376cd1 = _0x315cc9, _0x1d3fe2 = {
                    'dYacY': function (_0x4840f6, _0xcd5f51) {
                        const _0x40a8a6 = _0x378a;
                        return _0x3b8a7b[_0x40a8a6(0x15a)](_0x4840f6, _0xcd5f51);
                    }
                };
            return _0x3b8a7b[_0x376cd1(0x186)](_0x2bc24f, _0x33d613) ? _0x2bc24f : new _0x33d613(function (_0x4a6639) {
                const _0x161e85 = _0x376cd1;
                _0x1d3fe2[_0x161e85(0x16b)](_0x4a6639, _0x2bc24f);
            });
        }
        return new (_0x33d613 || (_0x33d613 = Promise))(function (_0x5b7d46, _0x355606) {
            const _0x55311c = _0x315cc9, _0x39ae9a = {
                    'ROhDs': function (_0x1fbb61, _0x23a5ee) {
                        const _0x2f3086 = _0x378a;
                        return _0x3b8a7b[_0x2f3086(0x15a)](_0x1fbb61, _0x23a5ee);
                    },
                    'wnZaw': function (_0x449d0c, _0x4e085a) {
                        const _0x311901 = _0x378a;
                        return _0x3b8a7b[_0x311901(0x18b)](_0x449d0c, _0x4e085a);
                    },
                    'rYxHr': function (_0x1f765f, _0x5b0a4d) {
                        const _0x46326e = _0x378a;
                        return _0x3b8a7b[_0x46326e(0x18d)](_0x1f765f, _0x5b0a4d);
                    },
                    'Ykpaz': _0x3b8a7b[_0x55311c(0x18e)]
                };
            function _0x4ecdbe(_0x2e5fd7) {
                const _0x55901f = _0x55311c;
                try {
                    _0x39ae9a[_0x55901f(0x165)](_0x21ab3b, _0x5af552[_0x55901f(0x162)](_0x2e5fd7));
                } catch (_0x554ac7) {
                    _0x39ae9a[_0x55901f(0x13f)](_0x355606, _0x554ac7);
                }
            }
            function _0x19dd6a(_0x4eb715) {
                const _0xedcd68 = _0x55311c;
                try {
                    _0x39ae9a[_0xedcd68(0x173)](_0x21ab3b, _0x5af552[_0x39ae9a[_0xedcd68(0x18f)]](_0x4eb715));
                } catch (_0x41bc08) {
                    _0x39ae9a[_0xedcd68(0x165)](_0x355606, _0x41bc08);
                }
            }
            function _0x21ab3b(_0x43aca4) {
                const _0x2b5e36 = _0x55311c;
                _0x43aca4[_0x2b5e36(0x164)] ? _0x3b8a7b[_0x2b5e36(0x15a)](_0x5b7d46, _0x43aca4[_0x2b5e36(0x17e)]) : _0x3b8a7b[_0x2b5e36(0x15a)](_0x3ec674, _0x43aca4[_0x2b5e36(0x17e)])[_0x2b5e36(0x174)](_0x4ecdbe, _0x19dd6a);
            }
            _0x3b8a7b[_0x55311c(0x14f)](_0x21ab3b, (_0x5af552 = _0x5af552[_0x55311c(0x184)](_0x60c9c1, _0x51d918 || []))[_0x55311c(0x162)]());
        });
    }, __importDefault = this && this[_0x20653d(0x155) + _0x20653d(0x168)] || function (_0x22af55) {
        const _0x240a00 = _0x20653d;
        return _0x22af55 && _0x22af55[_0x240a00(0x167)] ? _0x22af55 : { 'default': _0x22af55 };
    };
const _0x415dd6 = {};
function _0x378a(_0x40b391, _0x272808) {
    const _0x141126 = _0x3e0a();
    return _0x378a = function (_0x508e24, _0x423fe4) {
        _0x508e24 = _0x508e24 - (0x3 * -0x51f + 0x171d + -0x681);
        let _0x194df3 = _0x141126[_0x508e24];
        return _0x194df3;
    }, _0x378a(_0x40b391, _0x272808);
}
_0x415dd6[_0x20653d(0x17e)] = !![], Object[_0x20653d(0x181) + _0x20653d(0x151)](exports, _0x20653d(0x167), _0x415dd6);
const sequelize_1 = require(_0x20653d(0x175)), socketEmit_1 = __importDefault(require(_0x20653d(0x152) + _0x20653d(0x15c) + _0x20653d(0x188))), Message_1 = __importDefault(require(_0x20653d(0x154) + _0x20653d(0x158))), Ticket_1 = __importDefault(require(_0x20653d(0x154) + _0x20653d(0x189))), ShowTicketService_1 = __importDefault(require(_0x20653d(0x16e) + _0x20653d(0x16f) + _0x20653d(0x169) + _0x20653d(0x157))), CreateForwardMessageService = ({
        userId: _0x3f4406,
        tenantId: _0x42492e,
        message: _0x5e947a,
        contact: _0x4671da,
        ticketIdOrigin: _0x4a01be
    }) => __awaiter(void (-0x13e8 + -0x3 * -0xae0 + -0xcb8), void (0xd6d + -0x2 * -0x7e4 + 0x1d35 * -0x1), void (0x23c5 + -0x907 * 0x3 + 0x2 * -0x458), function* () {
        const _0x265a16 = _0x20653d, _0xac15b3 = {};
        _0xac15b3[_0x265a16(0x185)] = _0x265a16(0x140), _0xac15b3[_0x265a16(0x14c)] = _0x265a16(0x17f), _0xac15b3[_0x265a16(0x166)] = function (_0x2cf1ff, _0x593218) {
            return _0x2cf1ff === _0x593218;
        }, _0xac15b3[_0x265a16(0x143)] = function (_0x25b3bb, _0x385614) {
            return _0x25b3bb === _0x385614;
        }, _0xac15b3[_0x265a16(0x16c)] = _0x265a16(0x141), _0xac15b3[_0x265a16(0x156)] = _0x265a16(0x14d), _0xac15b3[_0x265a16(0x159)] = _0x265a16(0x150), _0xac15b3[_0x265a16(0x14e)] = _0x265a16(0x160), _0xac15b3[_0x265a16(0x18c)] = _0x265a16(0x187) + _0x265a16(0x161) + _0x265a16(0x17a), _0xac15b3[_0x265a16(0x17b)] = _0x265a16(0x142) + 'e';
        const _0x111b13 = _0xac15b3, _0x3ddb48 = {};
        _0x3ddb48['id'] = _0x4a01be, _0x3ddb48[_0x265a16(0x153)] = _0x42492e;
        const _0x435893 = yield (-0x2409 + -0x133d + 0x3746, ShowTicketService_1[_0x265a16(0x180)])(_0x3ddb48);
        let _0x3d5b05;
        const _0x5adccf = {
                [sequelize_1['Op']['or']]: [
                    _0x111b13[_0x265a16(0x185)],
                    _0x111b13[_0x265a16(0x14c)]
                ]
            }, _0x42525e = {};
        _0x42525e[_0x265a16(0x15f)] = _0x5adccf, _0x42525e[_0x265a16(0x153)] = _0x42492e, _0x42525e[_0x265a16(0x145)] = _0x4671da['id'];
        const _0x8c3d4e = {};
        _0x8c3d4e[_0x265a16(0x14a)] = _0x42525e, _0x3d5b05 = yield Ticket_1[_0x265a16(0x180)][_0x265a16(0x16d)](_0x8c3d4e);
        !_0x3d5b05 && (_0x3d5b05 = yield Ticket_1[_0x265a16(0x180)][_0x265a16(0x15e)]({
            'contactId': _0x4671da['id'],
            'status': _0x111b13[_0x265a16(0x185)],
            'isGroup': _0x4671da[_0x265a16(0x16a)],
            'userId': _0x3f4406,
            'tenantId': _0x42492e,
            'unreadMessages': 0x0,
            'whatsappId': _0x435893[_0x265a16(0x172)],
            'lastMessage': _0x5e947a[_0x265a16(0x171)],
            'lastMessageAt': new Date()[_0x265a16(0x14b)](),
            'answered': !![]
        }));
        const _0x3e65a5 = {
                'body': _0x5e947a[_0x265a16(0x171)],
                'contactId': _0x4671da['id'],
                'fromMe': !![],
                'read': !![],
                'mediaType': _0x111b13[_0x265a16(0x166)](_0x5e947a, null) || _0x111b13[_0x265a16(0x166)](_0x5e947a, void (-0x263d + -0x177 * 0x19 + 0x4adc)) ? void (-0x3 * -0x2a5 + 0x4f * -0x44 + 0xd0d) : _0x5e947a[_0x265a16(0x176)],
                'mediaUrl': _0x111b13[_0x265a16(0x166)](_0x5e947a, null) || _0x111b13[_0x265a16(0x143)](_0x5e947a, void (0x47 * -0x53 + 0x531 * 0x2 + 0xca3)) ? void (-0x1 * 0x2399 + -0x6 * 0x541 + 0x431f) : _0x5e947a[_0x265a16(0x144)],
                'mediaName': _0x111b13[_0x265a16(0x166)](_0x5e947a, null) || _0x111b13[_0x265a16(0x143)](_0x5e947a, void (0x226 * 0xa + 0x2 * -0x6a3 + -0x1 * 0x836)) ? void (-0x18ae + 0x1 * 0x13b2 + -0x13f * -0x4) : _0x5e947a[_0x265a16(0x144)],
                'timestamp': new Date()[_0x265a16(0x14b)](),
                'userId': _0x3f4406,
                'scheduleDate': null,
                'sendType': _0x111b13[_0x265a16(0x16c)],
                'status': _0x111b13[_0x265a16(0x14c)],
                'ticketId': _0x3d5b05['id'],
                'tenantId': _0x42492e
            }, _0x11b7f4 = yield Message_1[_0x265a16(0x180)][_0x265a16(0x15e)](_0x3e65a5), _0x2aa845 = {};
        _0x2aa845[_0x265a16(0x153)] = _0x42492e;
        const _0x2578ec = {};
        _0x2578ec[_0x265a16(0x149)] = Ticket_1[_0x265a16(0x180)], _0x2578ec['as'] = _0x111b13[_0x265a16(0x156)], _0x2578ec[_0x265a16(0x14a)] = _0x2aa845, _0x2578ec[_0x265a16(0x17d)] = [_0x111b13[_0x265a16(0x159)]];
        const _0x27ae0a = yield Message_1[_0x265a16(0x180)][_0x265a16(0x170)](_0x11b7f4['id'], {
            'include': [
                _0x2578ec,
                {
                    'model': Message_1[_0x265a16(0x180)],
                    'as': _0x111b13[_0x265a16(0x14e)],
                    'include': [_0x111b13[_0x265a16(0x159)]]
                }
            ]
        });
        if (!_0x27ae0a)
            throw new Error(_0x111b13[_0x265a16(0x18c)]);
        yield _0x3d5b05[_0x265a16(0x179)]({
            'lastMessage': _0x27ae0a[_0x265a16(0x171)],
            'lastMessageAt': new Date()[_0x265a16(0x14b)](),
            'answered': !![]
        });
        const _0x16f92f = {};
        _0x16f92f[_0x265a16(0x153)] = _0x42492e, _0x16f92f[_0x265a16(0x177)] = _0x111b13[_0x265a16(0x17b)], _0x16f92f[_0x265a16(0x18a)] = _0x27ae0a, (0x1 * -0xd21 + -0x1c * 0xf6 + 0x2809 * 0x1, socketEmit_1[_0x265a16(0x180)])(_0x16f92f);
    });
exports[_0x20653d(0x180)] = CreateForwardMessageService;