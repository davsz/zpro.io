'use strict';
const _0xb3407f = _0x4ad4;
(function (_0x4b3788, _0x4075d4) {
    const _0x5a7dd8 = _0x4ad4, _0x5c6ebe = _0x4b3788();
    while (!![]) {
        try {
            const _0x4ebbdc = -parseInt(_0x5a7dd8(0x15f)) / (0x5ec + 0x3fa * 0x9 + -0x1 * 0x29b5) * (parseInt(_0x5a7dd8(0x150)) / (0x310 + 0x2223 + -0x2531 * 0x1)) + -parseInt(_0x5a7dd8(0x100)) / (0xff8 + 0x1 * -0x21d9 + -0x1ca * -0xa) + -parseInt(_0x5a7dd8(0x143)) / (0xf6c + 0x13 * 0x1b1 + 0x2f8b * -0x1) * (parseInt(_0x5a7dd8(0x141)) / (0x2166 + -0x43b + -0x1d26)) + parseInt(_0x5a7dd8(0x137)) / (0xc7 + 0xad * -0x31 + 0x205c) * (-parseInt(_0x5a7dd8(0x170)) / (0xd9d + -0x253f + -0x1 * -0x17a9)) + parseInt(_0x5a7dd8(0x107)) / (-0x304 * 0x5 + 0x1 * -0x20c8 + -0xa * -0x4ca) + -parseInt(_0x5a7dd8(0xf8)) / (-0x28d * 0x1 + -0x1877 + 0x1b0d) + parseInt(_0x5a7dd8(0x17d)) / (-0x1561 + 0x295 + 0x12d6);
            if (_0x4ebbdc === _0x4075d4)
                break;
            else
                _0x5c6ebe['push'](_0x5c6ebe['shift']());
        } catch (_0x41359e) {
            _0x5c6ebe['push'](_0x5c6ebe['shift']());
        }
    }
}(_0x2931, 0x647dd + 0x81 * -0xb99 + 0x7 * 0xae26));
function _0x4ad4(_0x2836ee, _0x1cabe1) {
    const _0x5451d1 = _0x2931();
    return _0x4ad4 = function (_0x3004f6, _0x5c52fb) {
        _0x3004f6 = _0x3004f6 - (0x59f + -0x5 * -0x68c + -0x2565);
        let _0x3eee2d = _0x5451d1[_0x3004f6];
        return _0x3eee2d;
    }, _0x4ad4(_0x2836ee, _0x1cabe1);
}
function _0x2931() {
    const _0x320898 = [
        'update',
        'Error\x20send',
        'fluent-ffm',
        'ASC',
        'nant:\x20',
        'end',
        '2239416ZlyEUR',
        'error',
        'lte',
        'domTime',
        'assign',
        'CRKTV',
        'chat',
        'RHVCp',
        'peg',
        'mediaName',
        'xlbbh',
        'sendImage',
        'GpJdm',
        'contact',
        'LfSsx',
        'jpeg',
        'Error\x20mess',
        'pending',
        'ptt',
        'default',
        'APTZS',
        'sequelize',
        'XfbCq',
        'iHAKr',
        'rcnkc',
        'next',
        'document',
        'timestamp',
        'erty',
        'toFormat',
        'ers/socket',
        'sendAudio',
        'ZPFKn',
        'cBSui',
        'closed',
        'saveToFile',
        'voKeQ',
        'messengerI',
        'rhUkx',
        'messenger',
        'uKJVo',
        'sendFile',
        'vFixM',
        'done',
        'ketMessage',
        'fVypv',
        'tenantId',
        'video',
        '6jWdlro',
        'fs/promise',
        'sharp',
        'ls/Message',
        'mTime',
        'pOOdc',
        'defineProp',
        '\x20|\x20Ticket:',
        'readFile',
        '../../util',
        '7515dDwxtf',
        'fcpEe',
        '1252FuQUgM',
        'AscAq',
        'fault',
        '../../help',
        'ers/SetTic',
        'then',
        'ZMDdE',
        'aTZqP',
        'age\x20is\x20(te',
        's/sleepRan',
        '__esModule',
        'audio',
        '__awaiter',
        '2zqAylG',
        '.mp4',
        'findAll',
        'sleepRando',
        'ExndG',
        'ECQuV',
        'mediaUrl',
        'mp4',
        'value',
        'path',
        'image',
        'public',
        'oUNrc',
        'vyHWF',
        'sendText',
        '339006ywquze',
        'quotedMsg',
        'YqDDe',
        'iHcnk',
        'includes',
        ')::\x20',
        'KpUEC',
        'body',
        'xjfYZ',
        'logger',
        '__importDe',
        '\x20message\x20(',
        'id:\x20',
        'where',
        'messageId',
        'tXzxC',
        'split',
        '2491391BLzRtt',
        'apply',
        'mgHGu',
        'ls/Ticket',
        'sended',
        'toBuffer',
        '../../mode',
        'text',
        'bSvpi',
        's/logger',
        'sendVideo',
        'sAsRead',
        'veAHV',
        '17242340GbPlIP',
        'ticket',
        'VTWCq',
        'chat:ack',
        'filename',
        'dataValues',
        'applicatio',
        '3816234NORCRd',
        'mediaType',
        'file',
        'Emit',
        'throw',
        'XXXfH',
        'createdAt',
        'join',
        '222273jchDOh'
    ];
    _0x2931 = function () {
        return _0x320898;
    };
    return _0x2931();
}
var __awaiter = this && this[_0xb3407f(0x14f)] || function (_0x51c12a, _0x4f01f2, _0x15f1d0, _0x93b98e) {
        const _0x2e650a = _0xb3407f, _0x26d505 = {
                'voKeQ': function (_0x355f42, _0x289af9) {
                    return _0x355f42(_0x289af9);
                },
                'veAHV': function (_0x32758a, _0x2f1805) {
                    return _0x32758a instanceof _0x2f1805;
                },
                'tXzxC': function (_0x45c981, _0x804b12) {
                    return _0x45c981(_0x804b12);
                },
                'fVypv': _0x2e650a(0xfc),
                'rhUkx': function (_0x74c914, _0x5e0b9f) {
                    return _0x74c914(_0x5e0b9f);
                },
                'iHcnk': function (_0x5366f8, _0x92a791) {
                    return _0x5366f8(_0x92a791);
                }
            };
        function _0x48e74f(_0x30a402) {
            const _0x2e255a = _0x2e650a;
            return _0x26d505[_0x2e255a(0x17c)](_0x30a402, _0x15f1d0) ? _0x30a402 : new _0x15f1d0(function (_0x343e30) {
                const _0x4e77aa = _0x2e255a;
                _0x26d505[_0x4e77aa(0x12b)](_0x343e30, _0x30a402);
            });
        }
        return new (_0x15f1d0 || (_0x15f1d0 = Promise))(function (_0x2bca8c, _0x4fed25) {
            const _0x4b13de = _0x2e650a, _0x1e7886 = {
                    'uKJVo': function (_0x1061d8, _0x5e5aea) {
                        const _0x25e09c = _0x4ad4;
                        return _0x26d505[_0x25e09c(0x16e)](_0x1061d8, _0x5e5aea);
                    },
                    'APTZS': _0x26d505[_0x4b13de(0x134)],
                    'VTWCq': function (_0x2d4e76, _0x3f607c) {
                        const _0x1d0b9a = _0x4b13de;
                        return _0x26d505[_0x1d0b9a(0x12d)](_0x2d4e76, _0x3f607c);
                    }
                };
            function _0x1a2774(_0x4af5f5) {
                const _0x242f54 = _0x4b13de;
                try {
                    _0x26d505[_0x242f54(0x12b)](_0x3a041f, _0x93b98e[_0x242f54(0x120)](_0x4af5f5));
                } catch (_0x362ae7) {
                    _0x26d505[_0x242f54(0x12b)](_0x4fed25, _0x362ae7);
                }
            }
            function _0x2e3b4f(_0x395baa) {
                const _0x4545a5 = _0x4b13de;
                try {
                    _0x1e7886[_0x4545a5(0x12f)](_0x3a041f, _0x93b98e[_0x1e7886[_0x4545a5(0x11b)]](_0x395baa));
                } catch (_0x3ba6b8) {
                    _0x1e7886[_0x4545a5(0x17f)](_0x4fed25, _0x3ba6b8);
                }
            }
            function _0x3a041f(_0x406e95) {
                const _0x4a4f77 = _0x4b13de;
                _0x406e95[_0x4a4f77(0x132)] ? _0x26d505[_0x4a4f77(0x12b)](_0x2bca8c, _0x406e95[_0x4a4f77(0x158)]) : _0x26d505[_0x4a4f77(0x12b)](_0x48e74f, _0x406e95[_0x4a4f77(0x158)])[_0x4a4f77(0x148)](_0x1a2774, _0x2e3b4f);
            }
            _0x26d505[_0x4b13de(0x162)](_0x3a041f, (_0x93b98e = _0x93b98e[_0x4b13de(0x171)](_0x51c12a, _0x4f01f2 || []))[_0x4b13de(0x120)]());
        });
    }, __importDefault = this && this[_0xb3407f(0x169) + _0xb3407f(0x145)] || function (_0x442988) {
        const _0x5e48eb = _0xb3407f;
        return _0x442988 && _0x442988[_0x5e48eb(0x14d)] ? _0x442988 : { 'default': _0x442988 };
    };
const _0x5f5332 = {};
_0x5f5332[_0xb3407f(0x158)] = !![], Object[_0xb3407f(0x13d) + _0xb3407f(0x123)](exports, _0xb3407f(0x14d), _0x5f5332);
const promises_1 = require(_0xb3407f(0x138) + 's'), fluent_ffmpeg_1 = __importDefault(require(_0xb3407f(0x103) + _0xb3407f(0x10f))), path_1 = require(_0xb3407f(0x159)), sequelize_1 = require(_0xb3407f(0x11c)), sharp_1 = __importDefault(require(_0xb3407f(0x139))), SetTicketMessagesAsRead_1 = __importDefault(require(_0xb3407f(0x146) + _0xb3407f(0x147) + _0xb3407f(0x133) + _0xb3407f(0x17b))), socketEmit_1 = __importDefault(require(_0xb3407f(0x146) + _0xb3407f(0x125) + _0xb3407f(0xfb))), Message_1 = __importDefault(require(_0xb3407f(0x176) + _0xb3407f(0x13a))), Ticket_1 = __importDefault(require(_0xb3407f(0x176) + _0xb3407f(0x173))), logger_1 = require(_0xb3407f(0x140) + _0xb3407f(0x179)), sleepRandomTime_1 = require(_0xb3407f(0x140) + _0xb3407f(0x14c) + _0xb3407f(0x10a)), MessengerSendMessagesSystem = (_0x7b49f4, _0x430f92) => __awaiter(void (-0xa95 + 0x22ad + -0x1818), void (0x3 * -0xcd6 + -0x9 * -0x3b + 0xc25 * 0x3), void (0x255a + -0x1 * -0x1e22 + -0x21be * 0x2), function* () {
        const _0x39d283 = _0xb3407f, _0x24a608 = {
                'ZPFKn': _0x39d283(0x157),
                'oUNrc': _0x39d283(0x108),
                'ZMDdE': _0x39d283(0x106),
                'vFixM': _0x39d283(0x118),
                'aTZqP': _0x39d283(0x114),
                'GpJdm': _0x39d283(0x17e),
                'bSvpi': _0x39d283(0x129),
                'iHAKr': _0x39d283(0x12e),
                'fcpEe': _0x39d283(0x160),
                'RHVCp': _0x39d283(0xfe),
                'xlbbh': _0x39d283(0x104),
                'LfSsx': _0x39d283(0x10d),
                'xjfYZ': _0x39d283(0x177),
                'AscAq': _0x39d283(0x15b),
                'mgHGu': function (_0x5724b8, _0x235841) {
                    return _0x5724b8 === _0x235841;
                },
                'ExndG': _0x39d283(0x14e),
                'vyHWF': function (_0x76de02, _0x5ed169) {
                    return _0x76de02 === _0x5ed169;
                },
                'ECQuV': _0x39d283(0x119),
                'KpUEC': _0x39d283(0x15a),
                'XXXfH': _0x39d283(0x136),
                'rcnkc': _0x39d283(0xf7) + 'n',
                'CRKTV': _0x39d283(0xfa),
                'pOOdc': _0x39d283(0x121),
                'cBSui': _0x39d283(0x174),
                'YqDDe': _0x39d283(0x180),
                'XfbCq': function (_0x2df60e, _0x35bad8) {
                    return _0x2df60e(_0x35bad8);
                }
            }, _0x5b9de9 = { [sequelize_1['Op']['is']]: null }, _0x5a7637 = {
                'fromMe': !![],
                'messageId': _0x5b9de9,
                'status': _0x24a608[_0x39d283(0x131)],
                [sequelize_1['Op']['or']]: [
                    { 'scheduleDate': { [sequelize_1['Op'][_0x39d283(0x109)]]: new Date() } },
                    { 'scheduleDate': { [sequelize_1['Op']['is']]: null } }
                ]
            }, _0x1baa5d = yield Message_1[_0x39d283(0x11a)][_0x39d283(0x152)]({
                'where': _0x5a7637,
                'include': [
                    _0x24a608[_0x39d283(0x14a)],
                    {
                        'model': Ticket_1[_0x39d283(0x11a)],
                        'as': _0x24a608[_0x39d283(0x113)],
                        'where': {
                            'tenantId': _0x430f92,
                            [sequelize_1['Op']['or']]: {
                                'status': { [sequelize_1['Op']['ne']]: _0x24a608[_0x39d283(0x178)] },
                                'isFarewellMessage': !![]
                            },
                            'channel': _0x24a608[_0x39d283(0x11e)],
                            'whatsappId': _0x7b49f4['id']
                        },
                        'include': [_0x24a608[_0x39d283(0x14a)]]
                    },
                    {
                        'model': Message_1[_0x39d283(0x11a)],
                        'as': _0x24a608[_0x39d283(0x142)],
                        'include': [_0x24a608[_0x39d283(0x14a)]]
                    }
                ],
                'order': [[
                        _0x24a608[_0x39d283(0x10e)],
                        _0x24a608[_0x39d283(0x111)]
                    ]]
            });
        let _0x5f35d5;
        for (const _0x5083c8 of _0x1baa5d) {
            const _0x161ea1 = _0x5083c8, {ticket: _0x36e087} = _0x161ea1, _0x2a81a2 = _0x36e087[_0x39d283(0x114)][_0x39d283(0x12c) + 'd'];
            try {
                if (![
                        _0x24a608[_0x39d283(0x115)],
                        _0x24a608[_0x39d283(0x167)]
                    ][_0x39d283(0x163)](_0x161ea1[_0x39d283(0xf9)]) && _0x161ea1[_0x39d283(0x110)]) {
                    const _0x22bfb8 = (0x1e7e + -0x94 * -0x9 + -0x23b2, path_1[_0x39d283(0xff)])(__dirname, '..', '..', '..', _0x24a608[_0x39d283(0x144)]), _0x50494f = (-0x112a + 0x8 * -0x2d + 0x1292, path_1[_0x39d283(0xff)])(_0x22bfb8, _0x161ea1[_0x39d283(0x110)]), _0x5e02c2 = yield (0xd + 0xd * -0x16b + 0x1262, promises_1[_0x39d283(0x13f)])(_0x50494f);
                    if (_0x24a608[_0x39d283(0x172)](_0x161ea1[_0x39d283(0xf9)], _0x24a608[_0x39d283(0x154)]) || _0x24a608[_0x39d283(0x15d)](_0x161ea1[_0x39d283(0xf9)], _0x24a608[_0x39d283(0x155)])) {
                        const _0x24d289 = _0x161ea1[_0x39d283(0x110)][_0x39d283(0x16f)]('.'), _0x610a07 = (0x450 + 0x1bfb + 0x1 * -0x204b, path_1[_0x39d283(0xff)])(_0x22bfb8, _0x24d289[0x1 * 0x1a99 + -0x1b75 + 0x2c * 0x5] + _0x39d283(0x151));
                        yield new Promise((_0x1fb85f, _0x5f29ef) => {
                            const _0x10fefe = _0x39d283;
                            (0x221 * -0x3 + -0x1a0d + 0x2070, fluent_ffmpeg_1[_0x10fefe(0x11a)])(_0x50494f)[_0x10fefe(0x124)](_0x24a608[_0x10fefe(0x127)])['on'](_0x24a608[_0x10fefe(0x15c)], _0x4c294f => _0x5f29ef(_0x4c294f))['on'](_0x24a608[_0x10fefe(0x149)], () => _0x1fb85f(!![]))[_0x10fefe(0x12a)](_0x610a07);
                        });
                        const _0x4244de = yield (-0x12d4 + -0x1089 + 0x235d, promises_1[_0x39d283(0x13f)])(_0x610a07);
                        _0x5f35d5 = yield _0x7b49f4[_0x39d283(0x126)](_0x2a81a2, _0x4244de);
                    }
                    if (_0x24a608[_0x39d283(0x172)](_0x161ea1[_0x39d283(0xf9)], _0x24a608[_0x39d283(0x165)])) {
                        const _0x4d0621 = yield (0x27 * 0x31 + -0x888 * 0x1 + -0x5b * -0x3, sharp_1[_0x39d283(0x11a)])(_0x5e02c2)[_0x39d283(0x116)]()[_0x39d283(0x175)](), _0x1a7bd4 = {};
                        _0x1a7bd4[_0x39d283(0x181)] = _0x161ea1[_0x39d283(0x110)], _0x5f35d5 = yield _0x7b49f4[_0x39d283(0x112)](_0x2a81a2, _0x4d0621, _0x1a7bd4);
                    }
                    if (_0x24a608[_0x39d283(0x15d)](_0x161ea1[_0x39d283(0xf9)], _0x24a608[_0x39d283(0xfd)])) {
                        const _0x124f70 = {};
                        _0x124f70[_0x39d283(0x181)] = _0x161ea1[_0x39d283(0x110)], _0x5f35d5 = yield _0x7b49f4[_0x39d283(0x17a)](_0x2a81a2, _0x5e02c2, _0x124f70);
                    }
                    if ([
                            _0x24a608[_0x39d283(0x11f)],
                            _0x24a608[_0x39d283(0x10c)],
                            _0x24a608[_0x39d283(0x13c)]
                        ][_0x39d283(0x163)](_0x161ea1[_0x39d283(0xf9)])) {
                        const _0x1e35d2 = {};
                        _0x1e35d2[_0x39d283(0x181)] = _0x161ea1[_0x39d283(0x110)], _0x5f35d5 = yield _0x7b49f4[_0x39d283(0x130)](_0x2a81a2, _0x5e02c2, _0x1e35d2);
                    }
                }
                [
                    _0x24a608[_0x39d283(0x115)],
                    _0x24a608[_0x39d283(0x167)]
                ][_0x39d283(0x163)](_0x161ea1[_0x39d283(0xf9)]) && !_0x161ea1[_0x39d283(0x110)] && (_0x5f35d5 = yield _0x7b49f4[_0x39d283(0x15e)](_0x2a81a2, _0x161ea1[_0x39d283(0x166)]));
                const _0x3c96e6 = Object[_0x39d283(0x10b)](Object[_0x39d283(0x10b)](Object[_0x39d283(0x10b)]({}, _0x161ea1), _0x5f35d5), {
                        'id': _0x161ea1['id'],
                        'timestamp': _0x161ea1[_0x39d283(0x122)],
                        'messageId': _0x5f35d5[_0x39d283(0x16d)],
                        'status': _0x24a608[_0x39d283(0x128)],
                        'ack': 0x2
                    }), _0x2552e6 = {};
                _0x2552e6['id'] = _0x161ea1['id'];
                const _0x4eec5a = {};
                _0x4eec5a[_0x39d283(0x16c)] = _0x2552e6, yield Message_1[_0x39d283(0x11a)][_0x39d283(0x101)](Object[_0x39d283(0x10b)]({}, _0x3c96e6), _0x4eec5a), (-0x1fb1 + -0x13ee + 0xa53 * 0x5, socketEmit_1[_0x39d283(0x11a)])({
                    'tenantId': _0x36e087[_0x39d283(0x135)],
                    'type': _0x24a608[_0x39d283(0x161)],
                    'payload': Object[_0x39d283(0x10b)](Object[_0x39d283(0x10b)]({}, _0x161ea1[_0x39d283(0xf6)]), {
                        'mediaUrl': _0x161ea1[_0x39d283(0x156)],
                        'id': _0x161ea1['id'],
                        'timestamp': _0x161ea1[_0x39d283(0x122)],
                        'messageId': _0x5f35d5[_0x39d283(0x16d)],
                        'status': _0x24a608[_0x39d283(0x128)],
                        'ack': 0x2
                    })
                }), yield (-0xb72 + 0x1 * -0x191 + 0xd03, SetTicketMessagesAsRead_1[_0x39d283(0x11a)])(_0x36e087), yield (0x1f * 0xd3 + -0x258c + -0x53 * -0x25, sleepRandomTime_1[_0x39d283(0x153) + _0x39d283(0x13b)])({
                    'minMilliseconds': _0x24a608[_0x39d283(0x11d)](Number, 0x112e + 0x12dc + -0x2216),
                    'maxMilliseconds': _0x24a608[_0x39d283(0x11d)](Number, 0x1 * 0x115 + -0x11ef + 0x16b6)
                });
            } catch (_0x19d513) {
                const _0x8ab551 = _0x161ea1['id'], _0x321369 = _0x161ea1[_0x39d283(0x17e)]['id'];
                logger_1[_0x39d283(0x168)][_0x39d283(0x108)](_0x39d283(0x117) + _0x39d283(0x14b) + _0x39d283(0x105) + _0x430f92 + (_0x39d283(0x13e) + '\x20') + _0x321369 + ')'), logger_1[_0x39d283(0x168)][_0x39d283(0x108)](_0x39d283(0x102) + _0x39d283(0x16a) + _0x39d283(0x16b) + _0x8ab551 + _0x39d283(0x164) + _0x19d513);
            }
        }
    });
exports[_0xb3407f(0x11a)] = MessengerSendMessagesSystem;