'use strict';
function _0x1d5c() {
    const _0xcd2e34 = [
        'contact',
        'ls/Message',
        'fault',
        '4459347nVqISr',
        'next',
        'access_tok',
        'findOne',
        '../../mode',
        'iHrQW',
        'headers',
        'apply',
        'text\x20error',
        '__awaiter',
        '1193080WrAZwB',
        'text',
        'tenantId',
        'ok.com/v19',
        '__importDe',
        'zsOJN',
        'MYCFI',
        'mdNkr',
        '967628IstoXl',
        'warn',
        'avPwk',
        '2tuEtAq',
        'EyLJB',
        'payload',
        'messaging_',
        'n/json',
        'chat:ack',
        'CKIKD',
        'whatsapp',
        '../../erro',
        'sendMessag',
        '522138kajIKF',
        'https://gr',
        'en=',
        '859095wvSeMP',
        'DCPzs',
        'FNzMf',
        '38655eNIfmL',
        'fromMe',
        '../../help',
        'then',
        '.0/',
        '/messages?',
        'CONNECTED',
        'QOmQQ',
        'idFront',
        'data',
        'aph.facebo',
        'idztI',
        'SeRgm',
        'ls/Ticket',
        'YGsxx',
        'POST',
        'method',
        '8DZsvqr',
        'type',
        'rs/AppErro',
        'messages',
        'done',
        'ERR_WHATSA',
        'where',
        '126EYiUav',
        'DNjSG',
        'value',
        'VKTve',
        'PP_OFFLINE',
        'vRwnL',
        '../../util',
        'defineProp',
        'ack',
        'applicatio',
        'body',
        's/logger',
        'update',
        'ticket:upd',
        'now',
        'sended',
        'default',
        'product',
        'WABA\x20send\x20',
        'vCUMF',
        'status',
        'Emit',
        'url',
        'getTime',
        'ers/socket',
        '171409yDMAIs',
        'XSdqx',
        'cmtUO',
        '__esModule',
        'messageId',
        'axios',
        'logger',
        'bmToken',
        'Content-Ty',
        'ate',
        'Otgsz',
        'throw',
        'iJcoR',
        'KgPaZ',
        'ZDduT',
        'erty'
    ];
    _0x1d5c = function () {
        return _0xcd2e34;
    };
    return _0x1d5c();
}
const _0x487ef7 = _0xc7d4;
(function (_0x45f7b6, _0x1dc012) {
    const _0x5d6591 = _0xc7d4, _0x271120 = _0x45f7b6();
    while (!![]) {
        try {
            const _0x5aada6 = -parseInt(_0x5d6591(0x156)) / (-0x109 + 0x776 * 0x1 + -0x66c) * (-parseInt(_0x5d6591(0x14c)) / (-0x239 * -0x11 + 0x1 * -0x21e5 + -0x2 * 0x1f1)) + parseInt(_0x5d6591(0xf3)) / (0x1 * -0x8b0 + 0x1 * -0x258e + 0xf6b * 0x3) + -parseInt(_0x5d6591(0x149)) / (0x446 * -0x1 + 0x783 + -0x339) + parseInt(_0x5d6591(0x159)) / (0x1 * -0x1714 + 0xbd7 + 0xb42) + -parseInt(_0x5d6591(0x10b)) / (-0x104d + -0x1f01 + -0x34 * -0xe9) * (-parseInt(_0x5d6591(0x124)) / (-0x1a * 0x8 + 0x682 + -0x5ab)) + -parseInt(_0x5d6591(0x104)) / (0x70a + 0x16ab + 0x1dad * -0x1) * (parseInt(_0x5d6591(0x137)) / (0xb51 * -0x3 + 0x1ffc + 0x200)) + -parseInt(_0x5d6591(0x141)) / (-0x316 * 0x7 + -0x1 * -0x18a + 0xa0d * 0x2);
            if (_0x5aada6 === _0x1dc012)
                break;
            else
                _0x271120['push'](_0x271120['shift']());
        } catch (_0x2746d6) {
            _0x271120['push'](_0x271120['shift']());
        }
    }
}(_0x1d5c, -0x1 * -0x828b6 + -0x1bb41 * -0x5 + -0x4 * 0x2d06a));
var __awaiter = this && this[_0x487ef7(0x140)] || function (_0x44f6db, _0x433c61, _0x4e6cda, _0x483882) {
        const _0x20e4ed = _0x487ef7, _0x4023bd = {
                'EyLJB': function (_0x3d91e1, _0x1b89be) {
                    return _0x3d91e1(_0x1b89be);
                },
                'idztI': function (_0x5463e3, _0x54fd8e) {
                    return _0x5463e3 instanceof _0x54fd8e;
                },
                'FNzMf': function (_0x336e80, _0x219473) {
                    return _0x336e80(_0x219473);
                },
                'YGsxx': function (_0xba929e, _0x4f333c) {
                    return _0xba929e(_0x4f333c);
                },
                'cmtUO': _0x20e4ed(0x12f),
                'CKIKD': function (_0x7cbd3, _0x2ead94) {
                    return _0x7cbd3(_0x2ead94);
                },
                'mdNkr': function (_0x3101c7, _0x3ce288) {
                    return _0x3101c7(_0x3ce288);
                },
                'vRwnL': function (_0x40923a, _0x4dd426) {
                    return _0x40923a(_0x4dd426);
                }
            };
        function _0x4e8465(_0x2d263b) {
            const _0x4cf481 = _0x20e4ed;
            return _0x4023bd[_0x4cf481(0xfe)](_0x2d263b, _0x4e6cda) ? _0x2d263b : new _0x4e6cda(function (_0x5284a1) {
                const _0x3f5645 = _0x4cf481;
                _0x4023bd[_0x3f5645(0x14d)](_0x5284a1, _0x2d263b);
            });
        }
        return new (_0x4e6cda || (_0x4e6cda = Promise))(function (_0x33c5de, _0x7a5173) {
            const _0x2cc4dd = _0x20e4ed;
            function _0x21e871(_0x5dd3e9) {
                const _0x307271 = _0xc7d4;
                try {
                    _0x4023bd[_0x307271(0x14d)](_0x46b674, _0x483882[_0x307271(0x138)](_0x5dd3e9));
                } catch (_0x491f66) {
                    _0x4023bd[_0x307271(0xf2)](_0x7a5173, _0x491f66);
                }
            }
            function _0x5746e5(_0x48107a) {
                const _0x51c4af = _0xc7d4;
                try {
                    _0x4023bd[_0x51c4af(0x101)](_0x46b674, _0x483882[_0x4023bd[_0x51c4af(0x126)]](_0x48107a));
                } catch (_0x28e96f) {
                    _0x4023bd[_0x51c4af(0x152)](_0x7a5173, _0x28e96f);
                }
            }
            function _0x46b674(_0x234920) {
                const _0x3f2638 = _0xc7d4;
                _0x234920[_0x3f2638(0x108)] ? _0x4023bd[_0x3f2638(0x152)](_0x33c5de, _0x234920[_0x3f2638(0x10d)]) : _0x4023bd[_0x3f2638(0x148)](_0x4e8465, _0x234920[_0x3f2638(0x10d)])[_0x3f2638(0xf6)](_0x21e871, _0x5746e5);
            }
            _0x4023bd[_0x2cc4dd(0x110)](_0x46b674, (_0x483882 = _0x483882[_0x2cc4dd(0x13e)](_0x44f6db, _0x433c61 || []))[_0x2cc4dd(0x138)]());
        });
    }, __importDefault = this && this[_0x487ef7(0x145) + _0x487ef7(0x136)] || function (_0x3eeda1) {
        const _0x4a179c = _0x487ef7;
        return _0x3eeda1 && _0x3eeda1[_0x4a179c(0x127)] ? _0x3eeda1 : { 'default': _0x3eeda1 };
    };
const _0x4dad4e = {};
_0x4dad4e[_0x487ef7(0x10d)] = !![], Object[_0x487ef7(0x112) + _0x487ef7(0x133)](exports, _0x487ef7(0x127), _0x4dad4e);
function _0xc7d4(_0x36630b, _0x3947fb) {
    const _0x1032f2 = _0x1d5c();
    return _0xc7d4 = function (_0x10d15f, _0x310861) {
        _0x10d15f = _0x10d15f - (0x1e7 + 0xc6a + 0xd60 * -0x1);
        let _0x458840 = _0x1032f2[_0x10d15f];
        return _0x458840;
    }, _0xc7d4(_0x36630b, _0x3947fb);
}
const axios_1 = __importDefault(require(_0x487ef7(0x129))), Ticket_1 = __importDefault(require(_0x487ef7(0x13b) + _0x487ef7(0x100))), Message_1 = __importDefault(require(_0x487ef7(0x13b) + _0x487ef7(0x135))), socketEmit_1 = __importDefault(require(_0x487ef7(0xf5) + _0x487ef7(0x123) + _0x487ef7(0x120))), AppError_1 = __importDefault(require(_0x487ef7(0x154) + _0x487ef7(0x106) + 'r')), logger_1 = require(_0x487ef7(0x111) + _0x487ef7(0x116));
class SendMessage {
    [_0x487ef7(0x155) + 'e']({
        from: _0x5c164,
        phone_number_id: _0x91da70,
        message: _0xa1754a,
        ticket: _0x228caa,
        tenantId: _0x7659d6,
        idFront: _0x42b763,
        whatsapp: _0x19d35b
    }) {
        const _0x45f361 = _0x487ef7, _0x1e204c = {
                'DCPzs': function (_0x3a85b6, _0x3addd6) {
                    return _0x3a85b6 !== _0x3addd6;
                },
                'Otgsz': _0x45f361(0xf9),
                'zsOJN': _0x45f361(0x109) + _0x45f361(0x10f),
                'XSdqx': function (_0x30880b, _0xcb6ba4) {
                    return _0x30880b === _0xcb6ba4;
                },
                'QOmQQ': function (_0x21280e, _0x1eea7f) {
                    return _0x21280e === _0x1eea7f;
                },
                'MYCFI': _0x45f361(0x102),
                'iHrQW': _0x45f361(0x153),
                'VKTve': _0x45f361(0x114) + _0x45f361(0x150),
                'ZDduT': function (_0x51f57e, _0x494edf) {
                    return _0x51f57e || _0x494edf;
                },
                'avPwk': _0x45f361(0x142),
                'KgPaZ': _0x45f361(0x11a),
                'SeRgm': _0x45f361(0x118) + _0x45f361(0x12d),
                'iJcoR': _0x45f361(0x151),
                'DNjSG': _0x45f361(0x11d) + _0x45f361(0x13f),
                'vCUMF': function (_0x51d601, _0x590c05, _0x93f82b, _0x4b0df8, _0x2bf7e8) {
                    return _0x51d601(_0x590c05, _0x93f82b, _0x4b0df8, _0x2bf7e8);
                }
            };
        return _0x1e204c[_0x45f361(0x11e)](__awaiter, this, void (-0x12d9 + 0x24cb + 0x11f2 * -0x1), void (0x22da + -0x1ae5 + -0x7f5), function* () {
            const _0x6e53bd = _0x45f361;
            if (_0x1e204c[_0x6e53bd(0xf1)](_0x19d35b[_0x6e53bd(0x11f)], _0x1e204c[_0x6e53bd(0x12e)]))
                throw new AppError_1[(_0x6e53bd(0x11b))](_0x1e204c[_0x6e53bd(0x146)], 0x123 * -0x17 + 0x1c4 * 0x5 + -0x3 * -0x64b);
            try {
                const _0x467cf3 = _0x6e53bd(0x157) + _0x6e53bd(0xfd) + _0x6e53bd(0x144) + _0x6e53bd(0xf7) + _0x91da70 + (_0x6e53bd(0xf8) + _0x6e53bd(0x139) + _0x6e53bd(0x158)) + (_0x1e204c[_0x6e53bd(0x125)](_0x19d35b, null) || _0x1e204c[_0x6e53bd(0xfa)](_0x19d35b, void (0x106c + 0xacf + -0x1b3b)) ? void (0xb25 + 0xbfd + 0xe * -0x1a7) : _0x19d35b[_0x6e53bd(0x12b)]), _0x3ae2c4 = {};
                _0x3ae2c4[_0x6e53bd(0x115)] = _0xa1754a;
                const _0x3382d9 = {};
                _0x3382d9[_0x6e53bd(0x103)] = _0x1e204c[_0x6e53bd(0x147)], _0x3382d9[_0x6e53bd(0x121)] = _0x467cf3, _0x3382d9[_0x6e53bd(0xfc)] = {}, _0x3382d9[_0x6e53bd(0x13d)] = {}, _0x3382d9[_0x6e53bd(0xfc)][_0x6e53bd(0x14f) + _0x6e53bd(0x11c)] = _0x1e204c[_0x6e53bd(0x13c)], _0x3382d9[_0x6e53bd(0xfc)]['to'] = _0x5c164, _0x3382d9[_0x6e53bd(0xfc)][_0x6e53bd(0x142)] = _0x3ae2c4, _0x3382d9[_0x6e53bd(0x13d)][_0x6e53bd(0x12c) + 'pe'] = _0x1e204c[_0x6e53bd(0x10e)];
                const _0x1ec7fc = yield (0x1e2f + 0xbc1 + -0xa7c * 0x4, axios_1[_0x6e53bd(0x11b)])(_0x3382d9);
                let _0x119be3 = Date[_0x6e53bd(0x119)]();
                const _0x40610d = {
                        'messageId': _0x1ec7fc[_0x6e53bd(0xfc)][_0x6e53bd(0x107)][-0x1 * -0x1999 + -0x1162 * 0x1 + -0x837]['id'] || '',
                        'ticketId': _0x228caa['id'],
                        'contactId': _0x228caa[_0x6e53bd(0x134)]['id'],
                        'body': _0x1e204c[_0x6e53bd(0x132)](_0xa1754a, ''),
                        'fromMe': !![],
                        'mediaType': _0x1e204c[_0x6e53bd(0x14b)],
                        'read': !![],
                        'ack': 0x2,
                        'timestamp': _0x119be3,
                        'status': _0x1e204c[_0x6e53bd(0x131)]
                    }, _0x2f687a = {};
                _0x2f687a['id'] = _0x228caa['id'];
                const _0x1d48d = {};
                _0x1d48d[_0x6e53bd(0x10a)] = _0x2f687a;
                const _0x137b73 = yield Ticket_1[_0x6e53bd(0x11b)][_0x6e53bd(0x13a)](_0x1d48d);
                if (!_0x137b73)
                    return;
                yield _0x137b73[_0x6e53bd(0x117)]({
                    'lastMessage': _0x40610d[_0x6e53bd(0x115)],
                    'lastMessageAt': new Date()[_0x6e53bd(0x122)](),
                    'answered': _0x1ec7fc[_0x6e53bd(0xfc)][_0x6e53bd(0xf4)] || ![]
                });
                const _0x41ac1e = {};
                _0x41ac1e[_0x6e53bd(0xfb)] = _0x42b763, _0x41ac1e[_0x6e53bd(0x143)] = _0x7659d6;
                const _0xfe29f7 = {};
                _0xfe29f7[_0x6e53bd(0x10a)] = _0x41ac1e;
                const _0x1b84ab = yield Message_1[_0x6e53bd(0x11b)][_0x6e53bd(0x13a)](_0xfe29f7);
                if (!_0x1b84ab)
                    return;
                const _0x28228e = {};
                _0x28228e[_0x6e53bd(0x128)] = _0x1ec7fc[_0x6e53bd(0xfc)][_0x6e53bd(0x107)][-0x6e7 + 0x2b * 0x5a + -0x837]['id'], _0x28228e[_0x6e53bd(0x113)] = 0x2, _0x28228e[_0x6e53bd(0x11f)] = _0x1e204c[_0x6e53bd(0x131)], yield _0x1b84ab[_0x6e53bd(0x117)](_0x28228e);
                const _0x848181 = {};
                _0x848181[_0x6e53bd(0x143)] = _0x7659d6, _0x848181[_0x6e53bd(0x105)] = _0x1e204c[_0x6e53bd(0xff)], _0x848181[_0x6e53bd(0x14e)] = _0x228caa, (0xc3b * -0x2 + 0x1 * 0xfd1 + 0x8a5, socketEmit_1[_0x6e53bd(0x11b)])(_0x848181);
                const _0x300c07 = {};
                _0x300c07[_0x6e53bd(0x128)] = _0x1ec7fc[_0x6e53bd(0xfc)][_0x6e53bd(0x107)][0x58e * -0x2 + 0x76 * 0xb + 0x305 * 0x2]['id'], _0x300c07[_0x6e53bd(0x143)] = _0x7659d6;
                const _0x442df0 = {};
                _0x442df0[_0x6e53bd(0x10a)] = _0x300c07;
                const _0x17f974 = yield Message_1[_0x6e53bd(0x11b)][_0x6e53bd(0x13a)](_0x442df0);
                if (!_0x17f974)
                    return;
                const _0x30ba34 = {};
                return _0x30ba34[_0x6e53bd(0x143)] = _0x7659d6, _0x30ba34[_0x6e53bd(0x105)] = _0x1e204c[_0x6e53bd(0x130)], _0x30ba34[_0x6e53bd(0x14e)] = _0x17f974, (-0x1 * -0x7cf + -0x167 * -0x13 + -0xd2 * 0x2a, socketEmit_1[_0x6e53bd(0x11b)])(_0x30ba34), _0x1ec7fc[_0x6e53bd(0xfc)];
            } catch (_0x2ae043) {
                logger_1[_0x6e53bd(0x12a)][_0x6e53bd(0x14a)](_0x1e204c[_0x6e53bd(0x10c)]);
                throw _0x2ae043;
            }
        });
    }
}
exports[_0x487ef7(0x11b)] = SendMessage;